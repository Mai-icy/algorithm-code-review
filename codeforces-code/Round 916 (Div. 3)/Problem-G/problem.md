# G2. Light Bulbs
[question-URL](https://codeforces.com/contest/1907/problem/G)

**这个问题的简易版和困难版只在 $n$ 的限制条件上有所不同。在困难版本中，所有测试用例中 $n$ 的值之和不超过 $2 \cdot 10^5$ 。此外，对单个测试用例中的 $n$ 值没有额外的限制**。

有 $2n$ 个灯泡排成一行。每个灯泡的颜色从 $1$ 到 $n$ （**每种颜色正好有两个灯泡**）。

最初，所有灯泡都是关闭的。您选择一组灯泡 $S$ ，并将其打开。之后，您可以按照任意顺序多次执行以下操作：

- 选择两个灯泡 $i$ 和 $j$ **选择两个相同颜色的灯泡 $i$ 和 $j$ ，其中一个正好亮着，然后打开第二个；
- 选择三个灯泡 $i, j, k$ ，使得灯泡 $i$ 和 $k$ 都**亮且颜色相同**灯泡 $j$ 在它们之间（ $i \lt j \lt k$ ），并打开灯泡 $j$ 。

您希望选择一组灯泡 $S$ ，在最初打开时，通过执行所述操作，确保所有灯泡都打开。

计算两个数：

- 最初打开的灯泡组 $S$ 的最小尺寸；
- 最小集合 $S$ 的个数（取模 $998244353$ ）。

**输入**

输入的第一行包含一个整数 $t$ ( $1 \le t \le 10^4$ ) - 测试用例的数量。然后是测试用例的说明。

每个测试用例的第一行包含一个整数 $n$ ( $2 \le n \le 2 \cdot 10^5$ ) - 灯泡的对数。

每个测试用例的第二行包含 $2n$ 个整数 $c_1, c_2, \dots, c_{2n}$ ( $1 \le c_i \le n$ )( $1 \le c_i \le n$ ) ，其中 $c_i$ 是第 $i$ 个灯泡的颜色。从 $1$ 到 $n$ 的每种颜色，都有两个灯泡具有这种颜色。

输入的附加限制：所有测试用例中 $n$ 的值之和不超过 $2 \cdot 10^5$ 。


**输出**

对于每个测试用例，输出两个整数：

- 最初开启的集合 $S$ 的最小大小；
- 最小大小的集合 $S$ 的数量（取模 $998244353$ ）。

